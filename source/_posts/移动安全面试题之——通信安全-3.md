---
title: 移动安全面试题之——通信安全(3)
categories:
  - 面试相关
  - 移动安全面试题
tags:
  - 移动安全面试题
abbrlink: e54fffaf
date: 2025-09-28 09:08:33
---
## 一 概述

```
本文题目来自于：
 - 面试招聘要求
 - 网友分享
```

<!--more-->

## 二  面试要求和面试题

```
1.TLS / SSL 加密：避免明文 HTTP 传输
2.端到端加密：保证数据在两端才能解密
3.抓包风险：未加密通信易被 Charles、Wireshark 等拦截
4.防护措施：应用层 AES 加密 + TLS
5.证书锁定(Pinning)：防止中间人攻击，校验服务端证书是否可信
```

### 三 面试题解答(仅供参考)

### 3.1 TLS/SSL加密

Q1、什么是 TLS/SSL？

```
1、TLS/SSL：
传输层加密协议，用于保障网络通信的机密性、完整性、身份验证。

2、HTTP 不安全原因：
明文传输，容易遭受
窃听：数据可被截获（如密码、Token）。
篡改：传输中被修改。
伪装：中间人冒充合法服务器。
```

Q2、TLS/SSL 的三大安全机制是什么？

```
1、加密
-通过 非对称加密（RSA、ECC）协商 对称会话密钥（AES）。
-确保数据在传输中不会泄露。

2、完整性校验
-使用 MAC/HMAC（如 SHA-256） 确认数据未被篡改。

3、身份验证
-服务器通过 数字证书 向客户端证明身份，防止中间人伪装。
```

Q3、TLS 握手流程是怎样的？（简化版）

```
ClientHello：客户端发送支持的协议版本、加密套件
ServerHello：服务器返回选定的加密算法及证书
密钥交换：客户端验证证书，生成会话密钥
安全通信：双方使用对称密钥进行高效加密传输
Android/iOS使用OkHttp/URLSession处理握手
```

Q4、TLS 1.2 与 TLS 1.3 的区别是什么？

```
1、TLS 1.2
-握手耗时更长（多次往返）
-支持一些已过时的算法（如 SHA-1、RSA key exchange）

2、TLS 1.3 改进
-更快：1-RTT 或 0-RTT 握手，显著降低延迟
-更安全：移除不安全算法，强制使用 前向保密（PFS）
-更高效：协议简化，性能提升
2025年iOS 26强制TLS 1.3
```

Q5、TLS 1.3 的改进有什么意义？

```
TLS 1.3 提高了网络通信的安全性和性能，解决了 TLS 1.2 中的安全漏洞（如支持弱加密算法）
它采用 0-RTT 握手方式显著降低了延迟，同时加强了前向保密性，确保会话密钥在历史数据泄漏后仍然安全
```

Q6：TLS/SSL 的应用场景有哪些？

```
HTTPS（HTTP over TLS）：广泛用于银行、电商、支付、API 通信等场景
Android/iOS App使用HttpsURLConnection/URLSession强制HTTPS
```
Q7、E2EE（端到端加密）与 TLS 的区别是什么？

|      特性      |   TLS(传输层安全)    |       E2EE(应用层安全)        |
| :------------: | :------------------: | :---------------------------: |
|    保护范围    |   客户端 ↔ 服务器    |        发送端 ↔ 接收端        |
| 服务器可见数据 |      可解密明文      |        仅存储/转发密文        |
|    安全风险    | 服务器被攻破可能泄露 |  即使服务器被攻破也无法解密   |
|    应用场景    |    HTTPS、API通信    | 即时通讯、加密存储、医疗/金融 |


### 3.2 端到端加密(E2EE)

Q1、什么是端到端加密（E2EE）？

```
端到端加密（E2EE）：数据从发送端到接收端全程加密，中间节点（包括服务器）只能转发密文，无法访问明文。
```

Q2：E2EE 如何与 TLS 区别？

```
TLS：保护传输中的数据，服务器能够解密传输内容。
E2EE：只有通信双方能够解密数据，即使服务器被攻破，数据也无法泄露。
```

Q3、E2EE 的工作原理是什么？

```
1、原理
密钥生成：客户端生成公私钥对（RSA/ECDH）或对称密钥（AES）
密钥交换：通过安全协议（如 Diffie-Hellman）协商会话密钥
数据加解密：发送方用会话密钥加密，接收方解密
服务器角色：仅存储或转发密文，无法解密

2、常见技术栈：
OpenSSL、libsodium；Signal Protocol（WhatsApp、Signal/Android/iOS）；Apple RCS E2EE（iOS 26+）
```

Q4、为什么需要 E2EE

```
1、TLS 局限：
仅保护传输，服务器可见明文；若服务器被入侵或内部滥用，数据可能泄露

2、E2EE 优势：
-最高隐私保护：只有通信双方可解密
-防止数据泄露：服务器被攻破也只能获取密文

3、适用场景：
即时通讯、医疗数据传输、金融交易等高敏感场景
2025年iOS RCS支持跨平台E2EE
```

Q4、E2EE 面临哪些挑战？如何解决？

```
1、挑战：
-密钥管理：如何安全分发、备份密钥，防止丢失
-用户体验：简化密钥管理，提高易用性

2、解决方案：
-数字签名：结合 PKI 验证数据完整性与密钥可信度
-协议优化：使用成熟协议（Signal Protocol/Android/iOS）保障安全性和效率
-备份策略：云端加密备份，结合生物识别恢复
```

### 3.3 抓包风险

Q1、常用抓包工具有哪些？它们的工作原理是什么？

```
1、抓包（Packet Sniffing）：
使用工具（如 Wireshark、Charles）截获网络流量，分析或篡改数据

2、常见风险：
-明文传输：HTTP 流量易被读取，泄露密码、Token
-弱加密：过时 TLS 版本易被降级攻击
-证书伪造：自签名根证书导致 MITM

3、Android/iOS场景：
公共 Wi-Fi、Root/越狱设备易抓包
```

Q2、抓包工具如何工作？

```
-Charles/Burp Suite：代理服务器，拦截 HTTP/HTTPS 流量
-安装自签名 CA 证书绕过 TLS 验证
-风险：解密敏感数据、篡改请求/响应
```

Q3、如何检测抓包行为？

```
1、强制 HTTPS/TLS 1.3
2、证书锁定（Pinning）：客户端验证服务器证书公钥哈希
3、应用层加密：AES 加密数据 + TLS 传输
4、检测代理：检查网络配置，异常时拒绝连接
5、Android/iOS最佳实践：Network Security Config（Android）；ATS（App Transport Security/iOS）
```

### 3.4 应用层加密 + TLS

Q1、什么是应用层加密？如何与 TLS 结合？

```
1、应用层加密：
使用 AES 等算法加密数据内容，TLS 仅保护传输通道

2、实现：
-AES-256-GCM：加密数据，提供机密性与完整性（Android Cipher/iOS CommonCrypto）
-RSA/ECDH：密钥交换（Android KeyPairGenerator/iOS SecKeyGeneratePair）

2、TLS 保护：
-确保通信通过 HTTPS，使用 TLS 1.3 或强加密套件
-客户端验证服务器证书，防止伪造证书的 MITM 攻击

3、结合方式：
-客户端对敏感数据用 AES 加密，生成密文
-密文通过 TLS 加密通道传输至服务器
-服务器解密 AES 密文，获取明文数据

4、常见实践：
-AES + RSA：AES 用于加密数据，RSA 用于加密传输 AES 密钥，确保密钥安全
-应用场景：如银行 APP 将交易数据 AES 加密后通过 HTTPS 传输
```

2、注意事项

```
-密钥管理：确保密钥安全分发与存储，推荐使用密钥管理服务（KMS）或硬件安全模块（HSM）
-性能优化：AES 加密增加计算开销，建议选择高效算法（如 AES-GCM），并优化加密范围
-证书校验：结合 TLS 的证书锁定（Pinning），防止伪造证书攻击
```

3、AES-CBC vs AES-GCM

```
AES-CBC：仅提供加密，需额外 MAC（如 HMAC-SHA256）校验数据完整性，安全性依赖额外机制
AES-GCM：认证加密（AEAD），内置加密与完整性校验，性能更优，安全性更高，推荐使用
```

5、面试重点

```
双重保护：TLS 确保传输安全，AES 保护数据内容，即使 TLS 被攻破，数据仍不可读
场景适用性：适用于高敏感数据（如金融、医疗）的保护，结合 AES 和 RSA 可实现高效、安全的密钥传输
防护全面性：开发者需关注密钥管理、算法选择和性能优化，避免“仅依赖 TLS”的误区
```

5、一句话总结

```
结合应用层AES加密和传输层TLS提供双重安全保障，
AES保护数据内容，TLS保护传输通道，特别适合银行、支付等高敏感场景

使用 AES-GCM、RSA 和证书锁定等技术，结合安全密钥管理，可最大程度防范数据泄露和篡改风险
```

### 3.5 证书锁定(Pinning)

1、什么是证书锁定（Pinning）？其作用是什么？

```
1、概念
证书锁定是一种安全机制，通过在客户端预置服务器的证书或公钥指纹（hash），
确保只信任特定的证书或公钥，从而防止中间人攻击（MITM）

2、作用：
-防止 MITM 攻击：即使攻击者伪造证书或通过抓包工具（如 Charles）安装自签名根证书，
客户端也只会信任预置的证书/公钥，拒绝不匹配的连接

-增强 TLS 安全性：绕过操作系统或浏览器默认信任链，降低因信任链漏洞导致的风险

3、适用场景：
移动银行 APP、支付应用（如 PayPal）、IoT 设备等高安全性场景
```

2、如何实现证书锁定？

```
1、证书 Pinning：
-客户端硬编码服务器的完整证书或其指纹（hash）
-验证方式：连接时验证服务器返回的证书是否与预置证书匹配
-实现方式：
 Android：通过 network-security-config.xml 配置证书指纹，使用 OkHttp 的 CertificatePinner
 iOS：使用 URLSession 或 TrustKit 验证证书
 Web：推荐使用证书透明性（CT），HTTP Public Key Pinning（HPKP）已废弃

2、公钥 Pinning：
-锁定证书中的公钥指纹，允许证书更新但保持公钥不变，提供更大的灵活性
-客户端验证服务器证书的公钥哈希是否与预置值匹配

3、工作流程：
-客户端发起 TLS 握手，获取服务器证书
-验证证书/公钥是否与预置值一致，若不匹配，立即终止连接
```

3、证书锁定的优缺点

```
1、优点：
-高安全性：有效抵御 MITM 攻击，防止伪造证书或控制信任链
-针对性保护：适合移动应用和 IoT 设备，防止抓包工具（如 Charles）解密 HTTPS 流量

2、缺点：
-维护复杂：服务器证书过期或更换时，客户端需同步更新 Pinning 配置，否则可能阻断合法连接
-兼容性风险：配置错误可能导致连接失败，影响用户体验
-性能开销：验证过程增加少量计算开销

3、解决方案：
-设置备用 Pinning（备用证书/公钥）以应对证书更新
-结合证书透明性（CT），提高信任链可靠性
```

4、面试重点

```
1、核心价值：证书锁定通过限制信任范围，显著提升 TLS 安全性，防止伪造证书的 MITM 攻击
2、注意事项：需平衡安全性和维护成本，合理设计 Pinning 策略（如公钥 Pinning 更灵活）
3、实际应用：广泛用于金融、支付等高敏感场景，需结合密钥管理和 TLS 1.3 等技术
```

5、一句话总结

```
证书锁定通过预置服务器证书或公钥指纹，确保客户端只信任特定证书，高效防止 MITM 攻击，
特别适合移动应用和 IoT 设备
开发者需关注证书更新管理和性能优化，以避免兼容性问题
```

## 四 面试总结

```
TLS/SSL：网络传输安全的基础
E2EE：进一步保证数据隐私，连服务端也不可见
抓包风险：HTTPS 并非绝对安全，仍可能被劫持
应用层加密：在 TLS 上再加一层保护，提升安全性
证书锁定：防御中间人攻击，但需兼顾证书更新策略
```

